<div class="container mt-4">
  <div class="card p-4 shadow">
    <h4 class="mb-4 text-success">âž• Ajouter une sortie tissu</h4>

    <form [formGroup]="addForm" (ngSubmit)="ajouter()">
      <div class="row g-3">

        <div class="col-md-2">
          <label class="form-label">NÂ° BE</label>
          <input type="text" class="form-control" formControlName="numeroBE" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Client</label>
          <select class="form-select" formControlName="client">
            <option *ngFor="let c of clients" [value]="c">{{ c }}</option>
          </select>
        </div>

        <div class="col-md-2">
          <label class="form-label">Origine</label>
          <input type="text" class="form-control" formControlName="origine" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Date Sortie</label>
          <input type="date" class="form-control" formControlName="date" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Responsable</label>
          <input type="text" class="form-control" formControlName="responsable" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Motif</label>
          <input type="text" class="form-control" formControlName="motif" />
        </div>

        <div class="col-md-2">
          <label class="form-label">SPL</label>
          <input type="text" class="form-control" formControlName="spl" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Valeur BE</label>
          <input type="text" class="form-control" formControlName="valeurBE" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Ã‰tat</label>
          <input type="text" class="form-control" formControlName="etat" />
        </div>

        <div class="col-md-2">
          <label class="form-label">DAE / Facture</label>
          <input type="text" class="form-control" formControlName="facture" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Magasin</label>
          <select class="form-select" formControlName="magasin">
            <option *ngFor="let m of magasins" [value]="m.nom">{{ m.nom }}</option>
          </select>
        </div>

        <div class="col-md-12">
          <label class="form-label">Description</label>
          <textarea class="form-control" formControlName="description" rows="2"></textarea>
        </div>

        <hr class="my-2" />

        <div class="col-md-3">
          <label class="form-label">Article</label>
          <select class="form-select" formControlName="articleId">
            <option *ngFor="let a of articles" [value]="a.id">{{ a.ref }} - {{ a.libelle }}</option>
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">EntitÃ© de stock</label>
          <select class="form-select" formControlName="entiteStockId">
            <option *ngFor="let s of magasins" [value]="s.id">{{ s.nom }}</option>
          </select>
        </div>

        <div class="col-md-2">
          <label class="form-label">QuantitÃ©</label>
          <input type="number" class="form-control" formControlName="quantite" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Couleur</label>
          <input type="text" class="form-control" formControlName="couleur" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Lot</label>
          <input type="text" class="form-control" formControlName="lot" />
        </div>

        <div class="col-md-2">
          <label class="form-label">OA</label>
          <input type="text" class="form-control" formControlName="oa" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Laize</label>
          <input type="text" class="form-control" formControlName="laize" />
        </div>

        <div class="col-md-2">
          <label class="form-label">Qte Yard</label>
          <input type="text" class="form-control" formControlName="qteYard" />
        </div>

        <!-- âœ… Boutons d'action -->
        <div class="col-12 text-end mt-4">
          <button type="submit" class="btn btn-success me-2">
            <i class="bi bi-check-circle me-1"></i> Ajouter
          </button>
          <button type="button" class="btn btn-outline-success me-2" (click)="exportToExcel()">
            <i class="bi bi-file-earmark-excel me-1"></i> Exporter Excel
          </button>
          <button type="button" class="btn btn-outline-danger" (click)="exportToPDF()">
            <i class="bi bi-file-earmark-pdf me-1"></i> Exporter PDF
          </button>
        </div>

      </div>
    </form>
    <!-- ðŸ“‹ Liste des sorties enregistrÃ©es -->
<div *ngIf="resultats.length > 0" class="card shadow-sm p-4 mt-5">
  <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
    <h5 class="mb-0">ðŸ“‹ Sorties enregistrÃ©es : {{ resultats.length }}</h5>
    <div>
      <button type="button" class="btn btn-outline-success me-2" (click)="exportToExcel()">
        <i class="bi bi-file-earmark-excel me-1"></i> Exporter Excel
      </button>
      <button type="button" class="btn btn-outline-danger" (click)="exportToPDF()">
        <i class="bi bi-file-earmark-pdf me-1"></i> Exporter PDF
      </button>
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle text-center">
      <thead class="table-light">
        <tr>
          <th>RÃ©f.</th>
          <th>DÃ©signation</th>
          <th>QuantitÃ©</th>
          <th>EntitÃ© de stock</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of resultats">
          <td>{{ item.reference || '-' }}</td>
          <td>{{ item.designation || '-' }}</td>
          <td>{{ item.quantite || '-' }}</td>
          <td>{{ item.entiteStock || '-' }}</td>
          <td>{{ item.date || '-' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

  </div>
</div>
