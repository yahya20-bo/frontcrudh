<div class="container mt-4">
  <div class="card p-4 shadow-sm">
    <h5 class="mb-4 text-primary">
      <i class="bi bi-plus-circle me-2"></i> Ajouter une sortie article
    </h5>

    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="row g-3">

        <div class="col-md-2"><label>NÂ° BE</label><input type="text" class="form-control" formControlName="numeroBE" /></div>
        <div class="col-md-2"><label>Fournisseur</label>
          <select class="form-select" formControlName="fournisseur">
            <option *ngFor="let f of fournisseurs" [value]="f">{{ f }}</option>
          </select>
        </div>
        <div class="col-md-2"><label>Client</label>
          <select class="form-select" formControlName="client">
            <option *ngFor="let c of clients" [value]="c">{{ c }}</option>
          </select>
        </div>
        <div class="col-md-2"><label>Origine</label><input type="text" class="form-control" formControlName="origine" /></div>
        <div class="col-md-2"><label>Date</label><input type="date" class="form-control" formControlName="date" /></div>
        <div class="col-md-2"><label>Responsable</label><input type="text" class="form-control" formControlName="responsable" /></div>

        <div class="col-md-2"><label>Raison de sortie</label>
          <select class="form-select" formControlName="motif">
            <option value="UTILISATION">UTILISATION</option>
            <option value="RETOUR">RETOUR</option>
          </select>
        </div>
        <div class="col-md-2"><label>SPL</label><input type="text" class="form-control" formControlName="spl" /></div>
        <div class="col-md-2"><label>Valeur BE</label><input type="text" class="form-control" formControlName="valeurBE" /></div>
        <div class="col-md-2"><label>Ã‰tat</label><input type="text" class="form-control" formControlName="etat" /></div>
        <div class="col-md-2"><label>DAE / Facture</label><input type="text" class="form-control" formControlName="facture" /></div>
        <div class="col-md-2"><label>Magasin</label>
          <select class="form-select" formControlName="magasin">
            <option *ngFor="let m of magasins" [value]="m.nom">{{ m.nom }}</option>
          </select>
        </div>

        <div class="col-md-12"><label>Description</label>
          <textarea rows="2" class="form-control" formControlName="description"></textarea>
        </div>

        <hr class="my-3">

        <div class="col-md-3"><label>Article</label>
          <select class="form-select" formControlName="articleId">
            <option *ngFor="let a of articles" [value]="a.id">{{ a.ref }} - {{ a.designation || a.libelle }}</option>
          </select>
        </div>
        <div class="col-md-3"><label>EntitÃ© de stock</label>
          <select class="form-select" formControlName="stockId">
            <option *ngFor="let s of stocks" [value]="s.id">{{ s.nom }}</option>
          </select>
        </div>
        <div class="col-md-3"><label>QuantitÃ©</label><input type="number" class="form-control" formControlName="quantite" /></div>
        <div class="col-md-3"><label>Date</label><input type="date" class="form-control" formControlName="date" /></div>

        <div class="col-md-2"><label>Couleur</label><input type="text" class="form-control" formControlName="couleur" /></div>
        <div class="col-md-2"><label>Lot</label><input type="text" class="form-control" formControlName="lot" /></div>
        <div class="col-md-2"><label>OA</label><input type="text" class="form-control" formControlName="oa" /></div>
        <div class="col-md-2"><label>Laize</label><input type="text" class="form-control" formControlName="laize" /></div>
        <div class="col-md-2"><label>Qte Yard</label><input type="text" class="form-control" formControlName="qteYard" /></div>

        <div class="col-12 d-flex justify-content-end gap-2 mt-4">
          <button type="submit" class="btn btn-success">
            âœ… Valider
          </button>
          <button type="button" class="btn btn-outline-success" (click)="exportToExcel()">
            ðŸ“Š Exporter Excel
          </button>
          <button type="button" class="btn btn-outline-danger" (click)="exportToPDF()">
            ðŸ“„ Exporter PDF
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
