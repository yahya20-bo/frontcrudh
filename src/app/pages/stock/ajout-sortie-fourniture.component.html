<div class="container mt-5">
  <div class="card p-4 shadow-sm">
    <h5 class="mb-4 text-success">
      <i class="bi bi-plus-circle me-2"></i> Ajouter Sortie Fourniture
    </h5>

    <form [formGroup]="addForm" (ngSubmit)="onSubmit()">
      <div class="row g-3">

        <!-- Ligne 1 -->
        <div class="col-md-2"><label class="form-label">N° BE</label><input class="form-control" formControlName="numeroBE" /></div>
        <div class="col-md-2"><label class="form-label">Fournisseur</label>
          <select class="form-select" formControlName="fournisseur">
            <option *ngFor="let x of fournisseurs" [value]="x">{{ x.nom }}</option>

          </select>
        </div>
        <div class="col-md-2"><label class="form-label">Client</label>
          <select class="form-select" formControlName="client">
            <option *ngFor="let c of clients" [value]="c">{{ c }}</option>
          </select>
        </div>
        <div class="col-md-2"><label class="form-label">Origine</label><input class="form-control" formControlName="origine" /></div>
        <div class="col-md-2"><label class="form-label">Date Sortie</label><input type="date" class="form-control" formControlName="dateSortie" /></div>
        <div class="col-md-2"><label class="form-label">Responsable</label><input class="form-control" formControlName="responsable" /></div>

        <!-- Ligne 2 -->
        <div class="col-md-2"><label class="form-label">SPL</label><input class="form-control" formControlName="spl" /></div>
        <div class="col-md-2"><label class="form-label">Valeur BE</label><input class="form-control" formControlName="valeurBE" /></div>
        <div class="col-md-2"><label class="form-label">État</label><input class="form-control" formControlName="etat" /></div>
        <div class="col-md-2"><label class="form-label">DAE / Facture</label><input class="form-control" formControlName="facture" /></div>
        <div class="col-md-2"><label class="form-label">Magasin</label>
          <select class="form-select" formControlName="magasin">
            <option *ngFor="let m of magasins" [value]="m.nom">{{ m.nom }}</option>
          </select>
        </div>

        <!-- Description -->
        <div class="col-md-12"><label class="form-label">Description</label>
          <textarea class="form-control" rows="2" formControlName="description"></textarea>
        </div>

        <!-- Ligne 3 -->
        <div class="col-md-3"><label class="form-label">Article</label>
          <select class="form-select" formControlName="articleId">
            <option *ngFor="let article of articles" [value]="article.id">
              {{ article.ref }} - {{ article.designation }}
            </option>
          </select>
        </div>

        <div class="col-md-3"><label class="form-label">Entité de stock</label>
          <select class="form-select" formControlName="stockId">
            <option *ngFor="let s of stocks" [value]="s.id">{{ s.nom }}</option>
          </select>
        </div>

        <div class="col-md-2"><label class="form-label">Quantité</label>
          <input type="number" class="form-control" formControlName="quantite" />
        </div>

        <div class="col-md-2"><label class="form-label">Couleur</label>
          <input type="text" class="form-control" formControlName="couleur" />
        </div>

        <div class="col-md-2"><label class="form-label">Lot</label>
          <input type="text" class="form-control" formControlName="lot" />
        </div>

        <div class="col-md-2"><label class="form-label">OA</label>
          <input type="text" class="form-control" formControlName="oa" />
        </div>

        <div class="col-md-2"><label class="form-label">Laize</label>
          <input type="text" class="form-control" formControlName="laize" />
        </div>

        <div class="col-md-2"><label class="form-label">Qte Yard</label>
          <input type="text" class="form-control" formControlName="qteYard" />
        </div>
      </div>

      <!-- Boutons -->
      <div class="row mt-4">
        <div class="col-md-4">
          <button class="btn btn-success w-100" type="submit">
            <i class="bi bi-check-circle me-1"></i> Enregistrer
          </button>
        </div>
        <div class="col-md-4">
          <button type="button" class="btn btn-outline-success w-100" (click)="exportToExcel()">
            <i class="bi bi-file-earmark-excel me-1"></i> Exporter Excel
          </button>
        </div>
        <div class="col-md-4">
          <button type="button" class="btn btn-outline-danger w-100" (click)="exportToPDF()">
            <i class="bi bi-file-earmark-pdf me-1"></i> Exporter PDF
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
